 CREATE SCHEMA IF NOT EXISTS "mapa_do_acolhimento";
 ALTER TABLE public.mda_forms_answers  SET SCHEMA mapa_do_acolhimento; 
 CREATE OR REPLACE VIEW mapa_do_acolhimento.results_juridical_triage_1_form
 as select  
 cast( answers -> 'dados_voluntaria' -> 'email' as text) email_cadastro,
 cast( answers -> 'dados_voluntaria' -> 'nome_completo' as text) nome_completo, 
 cast( answers -> 'dados_voluntaria' -> 'whatsapp' as text) whatsapp,
 cast( answers -> 'criterios_projeto' -> 'maior_de_18' as text) maior_de_18,
 cast( answers -> 'criterios_projeto' -> 'reside_no_brasil' as text) reside_no_brasil,
 cast( answers -> 'criterios_projeto' -> 'brasileira' as text) brasileira,
 cast( answers -> 'criterios_projeto' -> 'situacao_de_violencia' as text) situacao_de_violencia,
 cast( answers -> 'criterios_projeto' -> 'periodo' as text) periodo,
 cast( answers -> 'criterios_projeto' -> 'tipos_de_violencia' as text) tipos_de_violencia,
 cast( answers -> 'criterios_projeto' -> 'autor_da_violencia' as text) autor_da_violencia,
 cast( answers -> 'criterios_projeto' -> 'situacao_vulnerabilidade_baixa_renda'  as text) situacao_vulnerabilidade_baixa_renda,
 cast( answers -> 'criterios_projeto' -> 'atendida_denfensoria_publica' as text) atendida_denfensoria_publica,
 cast( answers -> 'criterios_projeto' -> 'atendida_advogada_particular' as text) atendida_advogada_particular,
 cast( answers -> 'dados_acolhida' -> 'nome' as text) nome_acolhida,
 cast( answers -> 'dados_acolhida' -> 'data_de_nascimento' as text) data_de_nascimento,
 cast( answers -> 'dados_acolhida' -> 'regime_de_trabalho' as text) regime_de_trabalho,
 cast( answers -> 'dados_acolhida' -> 'renda_individual' as text) renda_individual,
 cast( answers -> 'dados_acolhida' -> 'tem_independencia_financeira' as text) tem_independencia_financeira,
 cast( answers -> 'dados_acolhida' -> 'tem_cadunico' as text) tem_cadunico,
 cast( answers -> 'dados_acolhida' -> 'recebe_algum_beneficio' as text) recebe_algum_beneficio,
 cast( answers -> 'dados_acolhida' -> 'responsavel_financeiramente' as text) responsavel_financeiramente,
 cast( answers -> 'dados_acolhida' -> 'divide_responsabilidade_com' as text) divide_responsabilidade_com,
 cast( answers -> 'dados_acolhida' -> 'tem_dependentes_financeiros' as text) tem_dependentes_financeiros,
 cast( answers -> 'dados_acolhida' -> 'quantidade_de_dependentes' as text) quantidade_de_dependentes,
 cast( answers -> 'dados_acolhida' -> 'recebe_pensao_alimenticia' as text) recebe_pensao_alimenticia,
 cast( answers -> 'moradia' ->'situacao_moradia' as text) situacao_moradia,
 cast( answers -> 'moradia' ->'cedida_por' as text) cedida_por,
 cast( answers -> 'moradia' ->'reside_com_o_autor_da_viloencia' as text) reside_com_o_autor_da_viloencia,
 cast( answers -> 'moradia' ->'sente_segura_em_casa' as text) sente_segura_em_casa,
 cast( answers -> 'moradia' ->'situacao_de_carcere' as text) situacao_de_carcere,
 cast( answers -> 'servico_publico' ->'conhece_redes_de_atendimento' as text) conhece_redes_de_atendimento,
 cast( answers -> 'servico_publico' ->'quais_redes_de_atendimento_conhece' as text) quais_redes_de_atendimento_conhece,
 cast( answers -> 'servico_publico' ->'atentendida_em_servico_publico' as text) atentendida_em_servico_publico,
 cast( answers -> 'servico_publico' ->'quais_servicos_publicos_atentida' as text) quais_servicos_publicos_atentida,
 cast( answers -> 'processo_juridico' -> 'areas_direito_demanda_se_enquadra' as text) areas_direito_demanda_se_enquadra,
 cast( answers -> 'processo_juridico' -> 'demanda_inicial' as text) demanda_inicial,
 cast( answers -> 'processo_juridico' -> 'encaminhamento' as text) encaminhamento,
 cast( answers -> 'processo_juridico' -> 'servicos_indicados' as text) servicos_indicados,
 upper(cast(answers -> 'risco' as text)) risco
from mapa_do_acolhimento.mda_forms_answers where form = 'triagem-juridico-1' and organization_id  = 360269610652;

CREATE OR REPLACE VIEW mapa_do_acolhimento.results_psychological_triage_1_form
as select
id,
created_at,
cast(answers->'dados_voluntaria'->'nome_completo' as text) nome_voluntaria,
cast(answers->'dados_voluntaria'->'email' as text) email_voluntaria,
cast(answers->'dados_voluntaria'->'whatsapp' as text) whatsapp_voluntaria,
cast(cast(answers->'criterios_projeto'->'e_maior_18' as text) as boolean) maior_18,
cast(cast(answers->'criterios_projeto'->'reside_no_brasil' as text) as boolean) reside_no_brasil,
cast(cast(answers->'criterios_projeto'->'brasileira' as text) as boolean) brasileira,
cast(cast(answers->'criterios_projeto'->'situacao_de_violencia' as text) as boolean) situacao_de_violencia,
cast(answers->'criterios_projeto'->'periodo' as text) periodo,
cast(answers->'criterios_projeto'->'tipos_de_violencia' as text) tipos_de_violencia,
cast(answers->'criterios_projeto'->'autor_da_violencia' as text) autor_da_violencia,
cast(cast(answers->'criterios_projeto'->'situacao_vulnerabilidade_baixa_renda' as text) as boolean) situacao_vulnerabilidade_baixa_renda,
cast(answers->'dados_acolhida'->'nome' as text) nome_acolhida,
cast(cast(answers->'dados_acolhida'->'data_de_nascimento' as text) as date) data_de_nascimento,
cast(answers->'dados_acolhida'->'regime_de_trabalho' as text) regime_de_trabalho,
cast(answers->'dados_acolhida'->'renda_individual' as text) renda_individual,
cast (cast(answers->'dados_acolhida'->'tem_independencia_financeira' as text) as boolean) tem_independencia_financeira,
cast(cast(answers->'dados_acolhida'->'tem_cadunico' as text) as boolean) tem_cadunico,
cast(cast(answers->'dados_acolhida'->'recebe_algum_beneficio' as text) as boolean) recebe_algum_beneficio,
cast(cast(answers->'dados_acolhida'->'responsavel_financeiramente' as text) as boolean) responsavel_financeiramente,
cast(cast(answers->'dados_acolhida'->'tem_dependentes_financeiros' as text) as boolean) tem_dependentes_financeiros,
cast(answers->'dados_acolhida'->'quantidade_de_dependentes' as text) quantidade_de_dependentes,
cast(answers->'moradia'->'situacao_moradia' as text) situacao_moradia,
cast(answers->'moradia'->'cedida_por' as text) cedida_por,
cast(cast(answers->'moradia'->'reside_com_o_autor_da_viloencia' as text) as boolean) reside_com_o_autor_da_viloencia,
cast(answers->'moradia'->'sente_seguram_em_casa' as text)  sente_seguram_em_casa,
cast(cast(answers->'moradia'->'situacao_de_carcere' as text) as boolean) situacao_de_carcere,
cast(cast(answers->'servico_publico'->'conhece_redes_de_atendimento' as text) as boolean) conhece_redes_de_atendimento,
cast(answers->'servico_publico'->'quais_redes_de_atendimento_conhece' as text) quais_redes_de_atendimento_conhece,
cast(cast(answers->'servico_publico'->'atentendida_em_servico_publico' as text) as boolean) atentendida_em_servico_publico,
cast(answers->'servico_publico'->'quais_servicos_publicos_atentida' as text) quais_servicos_publicos_atentida,
cast(answers->'processo_psicoterapeutico'->'demanda_inicial' as text) demanda_inicial,
cast(answers->'processo_psicoterapeutico'->'encaminhamento' as text) encaminhamento,
cast(answers->'processo_psicoterapeutico'->'qual_servico_publico' as text) qual_servico_publico,
upper(cast(answers->'risco' as text)) risco
from mapa_do_acolhimento.mda_forms_answers where form = 'triagem-psicologico-1' and organization_id  = 360282119532;

CREATE OR REPLACE VIEW mapa_do_acolhimento.results_juridical_triage_2_form
as select
 cast( answers -> 'dados_voluntaria' -> 'email' as text) email_cadastro,
 cast( answers -> 'dados_voluntaria' -> 'nome' as text) nome_completo,
 cast( answers -> 'dados_acolhida' -> 'nome' as text) nome_acolhida,
 cast( cast( answers -> 'dados_acolhida' -> 'data_de_nascimento' as text) as date) data_denascimento,
 cast( answers -> 'dados_acolhida' -> 'identidade_racial' as text) identidade_racial,
 cast( answers -> 'dados_acolhida' -> 'identidade_genero' as text) identidade_genero,
 cast( answers -> 'dados_acolhida' -> 'qual_deficiencia' as text) qual_deficiencia,
 cast( cast( answers -> 'dados_acolhida' -> 'pcd' as text) as boolean) pcd,
 cast( answers -> 'dados_acolhida' -> 'regime_de_bens' as text) regime_de_bens,
 cast( answers -> 'dados_acolhida' -> 'estado_civil' as text) estado_civil,
 cast( answers -> 'dados_acolhida' -> 'filhos_faixa_etaria' as text) filhos_faixa_etaria,
 cast( answers -> 'dados_acolhida' -> 'filhos_pcd' as text) filhos_pcd,
 cast( answers -> 'dados_acolhida' -> 'deficiencia_filhos'as text) deficiencia_filhos,
 cast( cast( answers -> 'dados_acolhida' -> 'tem_filhos' as text) as boolean) tem_filhos,
 cast (cast( answers -> 'dados_acolhida' -> 'gravida_ou_tem_recem_nascido' as text) as boolean) gravida_ou_tem_recem_nascido,
 cast( answers -> 'aspectos_socioeconomicos' -> 'escolaridade' as text) escolaridade, 
 cast(cast( answers -> 'moradia' -> 'local_de_risco' as text) as boolean) local_de_risco,
 cast( answers -> 'historico_violencia' -> 'tipos_violencia' as text) tipos_violencia,
 cast( answers -> 'historico_violencia' -> 'violencia_fisica_grave' as text) violencia_fisica_grave,
 cast( answers -> 'historico_violencia' -> 'violencia_fisica_extrema' as text) violencia_fisica_extrema,
 cast( cast( answers -> 'historico_violencia' -> 'se_sente_isolada' as text) as boolean) se_sente_isolada,
 cast( cast( answers -> 'historico_violencia' -> 'autor_tem_acesso_arma_fogo' as text) as boolean) autor_tem_acesso_arma_fogo,
 cast( answers -> 'historico_violencia' -> 'como_ameacou' as text) como_ameacou,
 cast(cast( answers -> 'historico_violencia' -> 'autor_ameacou_familiar' as text) as boolean)  autor_ameacou_familiar,
 cast(cast( answers -> 'historico_violencia' -> 'autor_obrigou_ato_sexual' as text) as boolean)autor_obrigou_ato_sexual,
 cast(cast( answers -> 'historico_violencia' -> 'violencia_durante_gravidez' as text) as boolean)  violencia_durante_gravidez,
 cast( answers -> 'historico_violencia' -> 'autor_comportamentos_abusivos' as text) autor_comportamentos_abusivos,
 cast( answers -> 'historico_violencia' -> 'acolhida_atendimento_medico' as text) acolhida_atendimento_medico,
 cast(cast( answers -> 'historico_violencia' -> 'acolhida_teve_interrese_em_separar' as text) as boolean) acolhida_teve_interrese_em_separar,
 cast(cast( answers -> 'historico_violencia' -> 'acolhida_tem_dependencia_emocional' as text) as boolean) acolhida_tem_dependencia_emocional,
 cast(cast(answers -> 'historico_violencia' -> 'frequencia_violencia_aumentou' as text) as boolean) frequencia_violencia_aumentou,
 cast(answers -> 'historico_violencia' -> 'autor_agrediu_outras_pessoas' as text) autor_agrediu_outras_pessoas,
 cast(cast(answers -> 'autor_da_violencia' -> 'tem_dominio' as text) as boolean) tem_dominio,
 cast(answers -> 'autor_da_violencia' -> 'quais_dominios' as text) quais_dominios,
 cast(cast(answers -> 'autor_da_violencia' -> 'usa_substancias_psicoativas' as text) as boolean) usa_substancias_psicoativas,
 cast(answers -> 'autor_da_violencia' -> 'quais_substancias' as text) quais_substancias,
 cast(cast(answers -> 'autor_da_violencia' -> 'diagnostico_doenca_psiquiatrica' as text) as boolean) diagnostico_doenca_psiquiatrica,
 cast(cast(answers -> 'servico_publico' -> 'acolhida_criticou_servicos_publicos' as text) as boolean) acolhida_criticou_servicos_publicos,
 cast(answers -> 'servico_publico' -> 'quais_servicos_publicos' as text) quais_servicos_publicos,
 cast(cast(answers -> 'processo_juridico' -> 'lei_maria_da_penha' as text) as boolean) lei_maria_da_penha,
 cast(answers -> 'processo_juridico' -> 'forma_de_viloencia' as text) forma_de_viloencia,
 cast(answers -> 'processo_juridico' -> 'lei_que_se_enquadra' as text) lei_que_se_enquadra,
 cast(answers -> 'processo_juridico' -> 'objetivo_da_demanda' as text) objetivo_da_demanda,
 cast(answers -> 'processo_juridico' -> 'resumo_demanda' as text) resumo_demanda,
 cast(answers -> 'processo_juridico' -> 'encaminhamento' as text) encaminhamento,
 cast(answers -> 'contato_contrato_com_acolhida' -> 'inicio_atendimento' as text) inicio_atendimento,
 cast(cast(answers -> 'contato_contrato_com_acolhida' -> 'contrato_pro_bono' as text) as boolean) contrato_pro_bono,
 cast(answers -> 'contato_contrato_com_acolhida' -> 'horas_atendimento_por_semana' as text) horas_atendimento_por_semana,
 cast(answers -> 'contato_contrato_com_acolhida' -> 'qual_fluxo_comunicao' as text) qual_fluxo_comunicao,
 cast(cast(answers -> 'contato_contrato_com_acolhida' -> 'frequencia_comunicacao' as text) as boolean) frequencia_comunicacao,
 cast(answers -> 'contato_contrato_com_acolhida' -> 'forma_segura_contato_com_acolhida' as text) forma_segura_contato_com_acolhida,
 cast(cast(answers -> 'assistencia_psicologica' -> 'tem_acompanhamento_psicologico' as text) as boolean) tem_acompanhamento_psicologico,
 cast(cast(answers -> 'assistencia_psicologica' -> 'via_mapa_do_acolhimento' as text) as boolean) via_mapa_do_acolhimento,
 cast(cast(answers -> 'assistencia_psicologica' -> 'entrou_em_contato_com_psicologa' as text) as boolean) entrou_em_contato_com_psicologa,
 upper(cast(answers -> 'risco' as text)) risco
 from mapa_do_acolhimento.mda_forms_answers mfa where form = 'triagem-juridico-2' and organization_id  = 360269610652;

CREATE OR REPLACE VIEW mapa_do_acolhimento.results_psychological_triage_2_form
as select
id,
cast( answers -> 'dados_voluntaria' -> 'nome' as text) nome_completo,
cast( answers -> 'dados_voluntaria' -> 'email' as text) email_de_cadastro,
cast( answers -> 'dados_acolhida' -> 'nome_acolhida' as text) nome_acolhida ,
cast(cast( answers -> 'dados_acolhida' -> 'data_de_nascimento' as text) as date) data_de_nascimento,
cast( answers -> 'dados_acolhida' -> 'identidade_racial' as text) identidade_racial,
cast( answers -> 'dados_acolhida' -> 'identidade_genero' as text) identidade_genero,
cast(cast( answers -> 'dados_acolhida' -> 'pcd' as text) as boolean) pcd,
cast( answers -> 'dados_acolhida' -> 'deficiencia' as text) deficiencia,
cast( answers -> 'dados_acolhida' -> 'estado_civil' as text) estado_civil,
cast(cast( answers -> 'dados_acolhida' -> 'tem_filhos' as text) as boolean) tem_filhos,
cast( answers -> 'dados_acolhida' -> 'filhos_faixa_etaria' as text) filhos_faixa_etaria,
cast( cast( answers -> 'dados_acolhida' -> 'filhos_pcd' as text) as boolean) filhos_pcd,
cast( answers -> 'dados_acolhida' -> 'filhos_pcd' as text) pcd_text,
cast( answers -> 'dados_acolhida' -> 'deficiencia_filhos' as text) deficiencia_filhos,
cast( cast( answers -> 'dados_acolhida' -> 'gravida_ou_tem_recem_nascido' as text) as boolean) gravida_ou_tem_recem_nascido,
cast( answers -> 'aspectos_socioeconomicos' -> 'escolaridade' as text) escolaridade,
cast( cast( answers -> 'moradia' -> 'local_de_risco' as text) as boolean) local_de_risco,
cast( answers -> 'qualidade_de_vida' -> 'impacto_sofrido_moderado' as text) impacto_sofrido_moderado,
cast( answers -> 'qualidade_de_vida' ->'impacto_sofrido_grave' as text) impacto_sofrido_grave,
cast( answers -> 'historico_violencia' -> 'tipos_violencia' as text) tipos_violencia,
cast( answers -> 'historico_violencia' -> 'violencia_fisica_grave' as text) violencia_fisica_grave,
cast( answers -> 'historico_violencia' -> 'violencia_fisica_extrema' as text) violencia_fisica_extrema,
cast(cast( answers -> 'historico_violencia' -> 'se_sente_isolada' as text) as boolean) se_sente_isolada,
cast(cast( answers -> 'historico_violencia' -> 'autor_tem_acesso_arma_fogo' as text) as boolean) autor_tem_acesso_arma_fogo,
cast( answers -> 'historico_violencia' -> 'como_ameacou' as text) como_ameacou,
cast(cast( answers -> 'historico_violencia' -> 'autor_ameacou_familiar' as text) as boolean) autor_ameacou_familiar,
cast(cast( answers -> 'historico_violencia' -> 'autor_obrigou_ato_sexual' as text) as boolean) autor_obrigou_ato_sexual,
cast(cast( answers -> 'historico_violencia' -> 'violencia_durante_gravidez' as text) as boolean) violencia_durante_gravidez,
cast( answers -> 'historico_violencia' -> 'autor_comportamentos_abusivos' as text) autor_comportamentos_abusivos,
cast( answers -> 'historico_violencia' -> 'acolhida_atendimento_medico' as text) acolhida_atendimento_medico,
cast(cast( answers -> 'historico_violencia' -> 'acolhida_teve_interrese_em_separar' as text) as boolean)  acolhida_teve_interrese_em_separar,
cast(cast( answers -> 'historico_violencia' -> 'acolhida_tem_dependencia_emocional' as text) as boolean) acolhida_tem_dependencia_emocional,
cast(cast( answers -> 'historico_violencia' -> 'frequencia_violencia_aumentou' as text) as boolean) frequencia_violencia_aumentou,
cast( answers -> 'historico_violencia' -> 'autor_agrediu_outras_pessoas' as text)  autor_agrediu_outras_pessoas,
cast( answers -> 'historico_violencia' -> 'quem_o_autor_agrediu' as text) quem_o_autor_agrediu,
cast(cast( answers -> 'autor_da_violencia' -> 'tem_dominio' as text) as boolean) tem_dominio,
cast( answers -> 'autor_da_violencia' -> 'quais_dominios' as text) quais_dominios,
cast(cast( answers -> 'autor_da_violencia' -> 'usa_substancias_psicoativas' as text) as boolean) usa_substancias_psicoativas,
cast( answers -> 'autor_da_violencia' -> 'quais_substancias' as text) quais_substancias,
cast(cast( answers -> 'autor_da_violencia' -> 'diagnostico_doenca_psiquiatrica' as text) as boolean) diagnostico_doenca_psiquiatrica,
cast(cast( answers -> 'servico_publico' -> 'acolhida_criticou_servicos_publicos' as text) as boolean) acolhida_criticou_servicos_publicos,
cast( answers -> 'servico_publico' -> 'quais_servicos_publicos' as text) quais_servicos_publicos,
cast( answers -> 'processo_psicoterapeutico' -> 'resumo_demanda' as text) resumo_demanda,
cast( answers -> 'processo_psicoterapeutico' -> 'encaminhamento' as text) encaminhamento, 
cast( answers -> 'contato_contrato_com_acolhida' -> 'inicio_atendimento' as text) inicio_atendimento,
cast( answers -> 'contato_contrato_com_acolhida' -> 'frequencia_atendimento' as text) frequencia_atendimento,
cast( answers -> 'contato_contrato_com_acolhida' -> 'forma_segura_contato_com_acolhida' as text) forma_segura_contato_com_acolhida,
cast( answers -> 'contato_contrato_com_acolhida' -> 'contrato' as text) contrato,
cast(cast( answers -> 'contato_contrato_com_acolhida' -> 'acordou_politica_falta' as text) as boolean) acordou_politica_falta,
cast(cast( answers -> 'assistencia_juridica' -> 'tem_acompanhamento_juridico' as text) as boolean) tem_acompanhamento_juridico,
cast(cast( answers -> 'assistencia_juridica' -> 'via_mapa_do_acolhimento' as text) as boolean) via_mapa_do_acolhimento,
cast(cast( answers -> 'assistencia_juridica' -> 'processo_juridico_em_andamento' as text) as boolean) processo_juridico_em_andamento,
cast(cast( answers -> 'assistencia_juridica' -> 'entrou_em_contato_advogada' as text) as boolean) entrou_em_contato_advogada,
cast(cast( answers -> 'atualizacoes_emergenciais' -> 'riscos_relacionados_suicidio' as text) as boolean) riscos_relacionados_suicidio,
upper(cast(answers -> 'risco' as text)) risco
from mapa_do_acolhimento.mda_forms_answers mfa where form = 'triagem-psicologico-2' and organization_id  = 360282119532;  