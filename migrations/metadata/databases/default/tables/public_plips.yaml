table:
  name: plips
  schema: public
object_relationships:
- name: widget
  using:
    foreign_key_constraint_on: widget_id
computed_fields:
- comment: Atributo computado a partir da relação entre widget_id e unique_identifier da tabela plip_signatures
  definition:
    function:
      name: plips_confirmed_signatures
      schema: public
  name: confirmed_signatures
- comment: "Atributo computado para retornar status a partir do período. Resultados: CONCLUIDO, PENDENTE ou INSCRITO"
  definition:
    function:
      name: plips_status
      schema: public
  name: status
select_permissions:
- permission:
    allow_aggregations: true
    columns:
    - created_at
    - expected_signatures
    - form_data
    - id
    - pdf_data
    - state
    - unique_identifier
    - updated_at
    - widget_id
    computed_fields:
    - confirmed_signatures
    filter:
      widget:
        block:
          mobilization:
            community:
              community_users:
                user_id:
                  _eq: X-Hasura-User-Id
  role: common_user
- permission:
    allow_aggregations: true
    columns:
    - created_at
    - expected_signatures
    - form_data
    - id
    - pdf_data
    - state
    - unique_identifier
    - updated_at
    - widget_id
    computed_fields:
    - confirmed_signatures
    filter:
      widget:
        block:
          mobilization:
            community:
              community_users:
                user_id:
                  _eq: X-Hasura-User-Id
  role: user
