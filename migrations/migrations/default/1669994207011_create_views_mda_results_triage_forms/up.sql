 CREATE SCHEMA IF NOT EXISTS "mapa_do_acolhimento";
 CREATE OR REPLACE VIEW mapa_do_acolhimento.results_juridical_triage_form
 as select  
 cast( answers -> 'dados_voluntaria' -> 'email' as text) email_cadastro,
 cast( answers -> 'dados_voluntaria' -> 'nome_completo' as text) nome_completo, 
 cast( answers -> 'dados_voluntaria' -> 'whatsapp' as text) whatsapp,
 cast( answers -> 'criterios_projeto' -> 'maior_de_18' as text) maior_de_18,
 cast( answers -> 'criterios_projeto' -> 'reside_no_brasil' as text) reside_no_brasil,
 cast( answers -> 'criterios_projeto' -> 'brasileira' as text) brasileira,
 cast( answers -> 'criterios_projeto' -> 'situacao_de_violencia' as text) situacao_de_violencia,
 cast( answers -> 'criterios_projeto' -> 'periodo' as text) periodo,
 cast( answers -> 'criterios_projeto' -> 'tipos_de_violencia' as text) tipos_de_violencia,
 cast( answers -> 'criterios_projeto' -> 'autor_da_violencia' as text) autor_da_violencia,
 cast( answers -> 'criterios_projeto' -> 'situacao_vulnerabilidade_baixa_renda'  as text) situacao_vulnerabilidade_baixa_renda,
 cast( answers -> 'criterios_projeto' -> 'atendida_denfensoria_publica' as text) atendida_denfensoria_publica,
 cast( answers -> 'criterios_projeto' -> 'atendida_advogada_particular' as text) atendida_advogada_particular,
 cast( answers -> 'dados_acolhida' -> 'nome' as text) nome_acolhida,
 cast( answers -> 'dados_acolhida' -> 'data_de_nascimento' as text) data_de_nascimento,
 cast( answers -> 'dados_acolhida' -> 'regime_de_trabalho' as text) regime_de_trabalho,
 cast( answers -> 'dados_acolhida' -> 'renda_individual' as text) renda_individual,
 cast( answers -> 'dados_acolhida' -> 'tem_independencia_financeira' as text) tem_independencia_financeira,
 cast( answers -> 'dados_acolhida' -> 'tem_cadunico' as text) tem_cadunico,
 cast( answers -> 'dados_acolhida' -> 'recebe_algum_beneficio' as text) recebe_algum_beneficio,
 cast( answers -> 'dados_acolhida' -> 'responsavel_financeiramente' as text) responsavel_financeiramente,
 cast( answers -> 'dados_acolhida' -> 'divide_responsabilidade_com' as text) divide_responsabilidade_com,
 cast( answers -> 'dados_acolhida' -> 'tem_dependentes_financeiros' as text) tem_dependentes_financeiros,
 cast( answers -> 'dados_acolhida' -> 'quantidade_de_dependentes' as text) quantidade_de_dependentes,
 cast( answers -> 'dados_acolhida' -> 'recebe_pensao_alimenticia' as text) recebe_pensao_alimenticia,
 cast( answers -> 'moradia' ->'situacao_moradia' as text) situacao_moradia,
 cast( answers -> 'moradia' ->'cedida_por' as text) cedida_por,
 cast( answers -> 'moradia' ->'reside_com_o_autor_da_viloencia' as text) reside_com_o_autor_da_viloencia,
 cast( answers -> 'moradia' ->'sente_segura_em_casa' as text) sente_segura_em_casa,
 cast( answers -> 'moradia' ->'situacao_de_carcere' as text) situacao_de_carcere,
 cast( answers -> 'servico_publico' ->'conhece_redes_de_atendimento' as text) conhece_redes_de_atendimento,
 cast( answers -> 'servico_publico' ->'quais_redes_de_atendimento_conhece' as text) quais_redes_de_atendimento_conhece,
 cast( answers -> 'servico_publico' ->'atentendida_em_servico_publico' as text) atentendida_em_servico_publico,
 cast( answers -> 'servico_publico' ->'quais_servicos_publicos_atentida' as text) quais_servicos_publicos_atentida,
 cast( answers -> 'processo_juridico' -> 'areas_direito_demanda_se_enquadra' as text) areas_direito_demanda_se_enquadra,
 cast( answers -> 'processo_juridico' -> 'demanda_inicial' as text) demanda_inicial,
 cast( answers -> 'processo_juridico' -> 'encaminhamento' as text) encaminhamento,
 cast( answers -> 'processo_juridico' -> 'servicos_indicados' as text) servicos_indicados,
 upper(cast(answers -> 'risco' as text)) risco
from public.mda_forms_answers where form = 'triagem-juridico-1' and organization_id  = 360269610652;

CREATE OR REPLACE VIEW mapa_do_acolhimento.results_psychological_triage_form
as select
answers -> 'dados_voluntaria' -> 'nome_completo' nome_completo,
answers -> 'dados_voluntaria' -> 'email' email,
answers -> 'dados_voluntaria' -> 'whatsapp' whatsapp,
answers -> 'criterios_projeto' ->'e_maior_18' e_maior_18,
answers -> 'criterios_projeto' ->'reside_no_brasil' reside_no_brasil,
answers -> 'criterios_projeto' ->'brasileira' brasileira,
answers -> 'criterios_projeto' ->'situacao_de_violencia' situacao_de_violencia,
answers -> 'criterios_projeto' ->'periodo' periodo,
answers -> 'criterios_projeto' ->'tipos_de_violencia' tipos_de_violencia,
answers -> 'criterios_projeto' ->'autor_da_violencia' autor_da_violencia,
answers -> 'criterios_projeto' -> 'situacao_vulnerabilidade_baixa_renda' situacao_vulnerabilidade_baixa_renda,
answers -> 'dados_acolhida' -> 'nome' nome_acolhida,
answers -> 'dados_acolhida' -> 'data_de_nascimento' data_de_nascimento,
answers -> 'dados_acolhida' -> 'regime_de_trabalho' regime_de_trabalho,
answers -> 'dados_acolhida' -> 'renda_individual' renda_individual,
answers -> 'dados_acolhida' -> 'tem_independencia_financeira' tem_independencia_financeira,
answers -> 'dados_acolhida' -> 'tem_cadunico' tem_cadunico,
answers -> 'dados_acolhida' -> 'recebe_algum_beneficio' recebe_algum_beneficio,
answers -> 'dados_acolhida' -> 'responsavel_financeiramente' responsavel_financeiramente,
answers -> 'dados_acolhida' -> 'tem_dependentes_financeiros' tem_dependentes_financeiros,
answers -> 'dados_acolhida' -> 'quantidade_de_dependentes' quantidade_de_dependentes,
answers -> 'moradia' -> 'situacao_moradia' situacao_moradia,
answers -> 'moradia' ->'cedida_por' cedida_por,
answers -> 'moradia' ->'reside_com_o_autor_da_viloencia' reside_com_o_autor_da_viloencia,
answers -> 'moradia' ->'sente_seguram_em_casa' sente_seguram_em_casa,
answers -> 'moradia' ->'situacao_de_carcere' situacao_de_carcere,
answers -> 'servico_publico' -> 'conhece_redes_de_atendimento' conhece_redes_de_atendimento,
answers -> 'servico_publico' -> 'quais_redes_de_atendimento_conhece' quais_redes_de_atendimento_conhece,
answers -> 'servico_publico' -> 'atentendida_em_servico_publico' atentendida_em_servico_publico,
answers -> 'servico_publico' -> 'quais_servicos_publicos_atentida' quais_servicos_publicos_atentida,
answers -> 'processo_psicoterapeutico' -> 'demanda_inicial' demanda_inicial,
answers -> 'processo_psicoterapeutico' -> 'encaminhamento' encaminhamento,
answers -> 'processo_psicoterapeutico' -> 'qual_servico_publico' qual_servico_publico,
upper(cast(answers -> 'risco' as text)) risco
from "public".mda_forms_answers where form = 'triagem-psicologico-1' and organization_id  = 360282119532 